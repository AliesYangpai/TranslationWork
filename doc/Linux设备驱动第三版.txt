目录：
前言-----
1.设备驱动的介绍---
设备驱动所扮演的角色
内核分离
设备和组件相关类
安全问题
版本号
许可说明
加入内核开发社区
总览本书

2.构建和运行组件--
安装自己的测试系统
Hello world--组件
内核组件与应用的对比
编译与加载
内核符号表
预处理
初始化和关闭
组件参数
在用户空间中使用
快速参考

3.字符驱动
scull的设计
主要和次要的数量
重要的数据结构
字符设备注册
开与释放
scull的内存使用
读和写
如何在新设备上应用
快速参考

4 调试技巧
在内核中如何调试
打印调试
查找调试
观测调试
调试系统错误
相关调试工具

5.并发与竞争环境
scull 中的pitfalls
并发与并发管理
信号与互斥
抢占
自旋锁
锁陷阱
上锁的替代方案
快速引用

6.字符驱动的高级操作
ioctl
IO阻塞
poll和select
异步通知
设备搜索
设备文件操作授权
快速参考

7.延时操作
时间管理
知晓当前时间
延迟执行
内核时间管理
子任务
工作对垒
快速参考

8.内存分配
kmalloc的一个真实故事
缓存
获取空闲页面与朋友
vmalloc 与朋友
CUP 预处理变量
获取大量缓存
快速参考

9.与硬件交互
IO 端口与IO 内存
使用IO端口
一个 IO 端口的案例
使用IO 内存
快速参考

10中断处理
预处理平行端口
载入一个打断Handler
Handler实现
顶部和底部的实现
打断分享
打断驱动IO
快速索引

11.内核中的数据类型
使用标准的C类型
给数据项分配指定大小的内存
特定接口类型
其他可以执行
关联列表
快速索引

12.PCI 驱动
PCI接口
ISA那点事儿
PC/104和PC/104+
其他PC 通信总线
SBUS
NuBUS
其他BUS
快速索引

13.USB驱动
USB设备基础
USB与系统
USB Urbs
编写USB驱动
USB无Urbs传输
快速索引

14.Linux设备模型
Kobjects, Ksets, and Subsystems
底级别的系统操作
热插拔事件处理
总线，设备与驱动
各种类
整合资源
热插拔
处理固件
快速索引

15内存映射与DMA
Linux中的内存管理
mmap内存映射操作
执行I/O操作
直接内存访问
快速索引

16.区块驱动
注册
区块设备操作
请求执行
其他详情
快速索引

17.网络驱动
null 的定义
连接内核
设备结构详情
打开和关闭
数据包传输
收据包接收
异常断开处理
异常断开容错处理
连接状态变化
Socket缓存
MAC 地址解决方案
自定义ioctl命令
统计信息
多播
其他详情
快速索引

18.TTY驱动
一个小的 TTY驱动
tty驱动功能指针
TTY设置
ioctls
程序与系统再TTY 设备上的处理
tty驱动结构详情
tty操作结构详情
tty基础结构先抢
快速引用

参考文献

索引
=================================================
前言
本书主要是介绍了Linux系统中的一些设备驱动，毫无疑问，这是很有价值的。硬件产品的更新迭代一直在快速的进行。有些人也许也准备在Linux上倒腾自己的新玩意儿。本书将会介绍Linux 内核的工作过程以及一些和读者工作
内容相关的一些适配。Linux是个开放系统，在本书的帮助下，在一些大开发者社区中，Linux将会变得更加令人接受.
这是Linux驱动第三版。自从本书第一次出版后，Linux内核已大有改变。我们也试图进行同步说明。这个版本包含了2.6.10的内核说明。我们这次省去了向后兼容的说明。在2.4的版本的中也是变化不少，2.4版本中的接口在第二版中我们也进行了说明。
当前版本包含了大量的关于2.6内核的原料说明。关于锁和并发等操作已经扩展到各自的章节中。Linux 2.6版本的Linux设备模型也进行了详细说明。在USB 总线与线性驱动子系统中也有新的章节进行说明。PCI章节也进行了大量扩充。每个章节在本书都进行了彻底更新。

Jon---
这个版的书非常契合我12年的Linux工作生涯，以及我25年的电脑开发生涯，真的很惊艳。自1980年后，计算机的更新脚步变得非常之快。Linux 设备驱动更新着实增加了不少的挑战。Linux 内核的机灵鬼儿们也在不断地改进着他们的代码，可是却鲜有注释，让其他人难以接手。
Linux在市场上取得了持续的成功，在全球范围的开发者心中都有着重要的地位。Linux早期的成功在于它的高质量能力与免费开源。不过在我而言，Linux真正的成功是能够在从实际触发并重新带来计算机的乐趣。在Linux中，非常欢迎任何人玩转系统沙盒。而这些系统科技也是远高于此。Linux不单单是给我们提供了一个顶级开源操作系统，同时也给我们了一个成为它未来开发者的机会从而尽情享受Linux带来的乐趣。
在我25年的工作生涯中，从开发第一态Gray 电脑到探索迷你电脑和UNIX 工作站，直到现在开发微处理器执行单元，我从未感到过生活充实，工作又去。我也从未彻底研究过自己的开发设备与迭代。Linux，说白了就是一个免费的软件，一个清晰而强大的背后驱动。
我希望这一版能给一些新的Linux开发这带来机遇与乐趣。不管你在乎内核还是用户控件，我都希望这本书能引导你学习内核是怎样个与硬件工作的。我希望本书能帮助并鼓励你猛烈编码并将开源系统做的更好。Linux还有很长的路要走，而现在也仅仅是开始；想要知道机制到底是怎么样的，动手操作比干瞪眼来的更有趣。

Alessandro---
我喜欢用电脑，因为他们可以和硬件交互。当我卖掉了大学给我的苹果2和ZX Spectrum后，当我加载了GUN/Linux并在新的386上，我终于可以从Dos的陷阱中逃离出来了，终于我又再次打开了我的电烙铁。
在那时候，开发者社区规模很小。周围也没有什么关于驱动编写的文档。因此，我就开始写Linux的日志。这就是
起点：当我后来发现，我不喜欢念大学后，我就不上了，之后我就和O Reilly 签订了合约
那是1996年
现在的计算实际世界已经完全不同了：免费软件似乎是一个不错的方案，还有各种科技政策。不过在各个领域还有很多事情要做。我希望这本书有2个目的：分享知识与提高对知识分享的认知。这是为什么在第一版证明了广大开发这对Linux的兴趣，之后，灵位坐着开始在开始在第二版交替发出可用许可。我敢打赌这是正确的获取知识的方式，而且这一版的内容非常适合和他人一起分享。
非常激动我看到了内置的竞技场，我希望这些文本能有搜帮帮助；这两天想法很多。而且已经在计划设计第四版的书籍了，并且也在寻找第四个人帮助一起编纂

Greg介绍---
很早之前为了琢磨怎样真正完成一个Linux驱动，我就开始使用第一版的Linux Device Book了。这本书很有导向性的帮助我了解我用了多年的开源系系统，但内核我却很少有时间去研究。在这本书的帮助下，并且在研读了其他开发者在内核中的代码后，我的一个大bug爆发了。而SMP-unsafe driver 也被内核社区接受了，并且合入到了内核主干。尽管我5min后收到了bug 报告，但我仍然着迷于尽我所能完善这个开源系统。
很荣幸，我能为本书做出贡献。我希望在我的贡献下，能够帮助到其他人了解到内核的细节，发现并且能够认知到驱动开发并不是那么恐怖，并不是一个开发者禁地。并且能够公里他人加入到开发中，并贡献自己的一份力，让我们的开源系统在各个平台和设备兼容性上都更上一层楼。开发过程很有意思，而且开发社区也给力，人人有功练。
现在通过修改结果bug在回来编写这一版的内核驱动书记。变更下API 让他们更为合理易懂，同时加入了一些新特性，来吧，我们会一直互助学习下去的。

对于读者：
本书适用于一些想从业电脑内部运行以及一些处理Linux盒子问题的开发这。需要注意的是“Linux盒子”相对于运行Linux的PC是更广义的概念。因为很多上层系统平台都支持开源的Linux系统，内核的开发均不是仅限于指定平台。我们希望这本书能够帮助一些迷茫的人们找到成为“内核达人”的起点。
对于技术方面， 文本描述更倾向于对于了解内核以及Linux开发者设计方案的动手实践。尽管对于大方向上，本书的目标是教会大家怎样编写设备驱动，以及对内核实现的综述说明。当然了一些开发者也可以通过官方内核源码找到一些必要信息。不过通常来说，一些必要的记录也是能够帮助大家提高编码技能。如要要想真正理解这些对于内核的描述，是需要花时间，并且耐心的学习内存源码，我们希望你的收获肯定配得上你的努力付出。
Linux的狂热粉会发现本书足够他们在源码中尽情玩耍，并且他们也应当加入到开发者社区，持续为新的系统能力与功能增强做出贡献。当然了本书并不能覆盖到整个Linux的方方面面。而对于每个Linux 设备驱动的作者需要知道的是这些驱动是怎样在众多内核子系统上工作的。因此，在通常在内核编码时，本书都会做详尽的介绍。Linux系统仍然是一个不断迭代更新的系统。对于新开发者来说依旧是有很多大显身手的地方的。
另一方面，如果你仅仅是想在给自己的设备上开发一些驱动，并且你不想与内核掺和，一些案例模型也足够你玩耍了，如果你不想深入了解细节，你可以跳过一些技术模块，直接使用那些可以无缝对接内核，并用于设备驱动的的标准API

材料组织：
本书的每节标题内容将会按照复杂度从简到难依次介绍，并且分为2个部分。第一部分（1-11章节）介绍了内核模型的载入，同时介绍了char-类型设备各个方面与全量特征的编码注意事项。每个章节都覆盖了不同的问题，并在结尾处包含了总结，此总结在实际开发中非常具备参考意义。
在整个第一部分的内容中，从软件方面到关联硬件，组织材料这部分介绍的还是相对粗糙的。这部分组织说明意味着，允许你不要使用额外设备，尽可能使用自己的电脑来进行软件测试。每个章节都包含了相关源码，并且给到了驱动实例代码，可以运行在各类Linux系统的电脑下。在章节1.1我们要求你使用一英尺的电线来连接平行端口，目的是为了测试硬件，这部分的基础设备是必要的基础环境。
本书的第二部分（12-18章节）描述了一大部分驱动以及网络接口，并且深入描述了一些高阶内容，比如子系统中如何与虚拟内存协调工作、一些PCI和USB总线等。很多驱动作者不必面面俱到，但我们还是鼓励你阅读学习他们。当你在探索Linux内核的工作原理时，你就会发现这些原料信息其实是很有趣的。即便是你不涉及这部分项目。

背景信息：
如果要想使用学习本书，你必须具备C语言编程基础，也需要有些Unix的经验，我们常常呼引用一些Unix语法来解释说明系统调用，命令，管道等。
在硬件这一层，如果没有这部分的经验，那么就需要了解本书中材料这个章节了，要能提前知晓一些通用概念。这些文本说明并不是特指某些PC硬件，对于特殊硬件我们会专门说明。
在内核构建时，也需要一些免费的软件工具，你在使用时，需要指明这些工具的版本。一些比较老的版本会存在特性缺失，而一些新的版本又会造成内核构建崩溃。通常来说，工具的发行版本就ok了。不同的内核需要不同的工具版本；可以根据个人的内核版本，请在源码树中查询Documentation/Changes寻找对应的工具版本。

在线版本与许可：
作者们为了让本书与相关源码资源更加贴合，已选择 "Attribution-ShareAlike"的许可，版本为2.0

本书的使用规范：
以下为本书中字体的使用规范：
斜体：
用于文件或路径名，程序、命令名称，命令行设置，URL
宽体常量：
用于展示案例中文件内容或命令输出内容，这种文本在说明信息时，一般出现在C代码和其他字符串中。
斜体常量：
常用于表示命令用于替换实际值的操作时的命令
常量加粗：
常用于表示命令或其他文本在用户层的常规使用。
特别留意一下图标右侧的说明：
icon1---这是个说明，这里对于话题包含了有用的信息。
icon2---这是警告，帮助你解决和避免一些烦人的问题。

代码案例
本书能帮助你完成你的工作。通常来说，你可以将本书中的code应用在你的程序与文档中。这些code案例属于BSD/GPL的许可

我们希望你得到你的反馈
发布者们也很希望得到读者的问题反馈
对于本书，我们有专门的网站，我们列出勘误表，案例，和其他二外信息。读者可以在从以下访问

Safari的支持
如果你在你最喜欢的科技书记中看到了Safari的注册，这就意味这这本书能够在Safari上在线浏览
Safari提供了比电子书更好的解决方案。那里有大量的书库可以让你轻松搜索到尖端科技书籍、代码片段，下载章节等，
当你需要更新，更精准的信息时，也能够快速找到。请看···

鸣谢
这本书并不是凭空捏来的，我们非常感本书所有的贡献者。
感谢Andy Oram；多亏了他的努力，本书能够可以量产发型。我们也亏欠于一些聪明人，亏欠于哲学与他们的免费软件实践。

第一版的技术Review是Alan Cox，Greg Hankins，Hans Lermen，Heiko Eissfeldt还有 Miguel de Icaza(按照姓氏首字母排序)。第二版是Allan B.Cruse,Christian Morger, Jake Edge, Jeff Garzik, Jens Axboe.. 第三版是xxx。 这些人在帮助出书的时后花了大量的努力定位问题，并指出改进。
最后，我们也同样感谢Linux开发者对其工作的兢兢业业。包括内核与用户空间的开发者。这本书我们选择不使用名称称呼他们，这样为了避免遗漏。有时候，如果称呼错误，请包涵

Jon
首先，我要感谢我老婆Laura 和我的孩子们 Michele 、Giulia，感谢他们在我全力编纂本书时能够耐心排解我烦恼。在LWN.net的慷慨帮助下，也促成本书的初版。还有Linux 内核的开发者们帮助我成为社区的医院，并且能在我困惑的时候给到我最有效的解决方案。感谢那些来自世界各地的读者们，他们在第二版曾给到我们很多留言与建议，这让我们在编纂时更有动力，更有灵感。这里我还要特备鸣谢下第一版的实践者，并且仍然持续活跃在第三版中的Alessdro Rubini，他是我们的牵头人；还有Greg Kroah-Hartman，他在各个章节都提供了相当多的技术支持，并且让我们收益颇丰。

Alessandro
很感谢在大家共同努力下，我们完成了第三版的编纂。首先，感谢极具耐心的Federica，在我们度蜜月时，支持我重新审核第一版书籍，那会儿我就是在帐篷里用一个笔记本完成了Review。我也要谢谢Giorgio 和Guilia，他们参与了后续版本的编写，同时也非常愿意成为加班到深夜的“牛羚”之子。这里我也很感激那些免费软件的作者们，是他们教会了我怎样兼容他们的code能够在各种场景下使用。对于这个版本，我最感激的是Jon和Greg他们俩是本书的肱股之臣。没有他俩的帮助，就没有本书的成功。尤其是随着code 越来越多体积越来越庞大，我的时间也是非常有限，经常要处理读者问题，免费软件问题，过期问题。本书中，Jon是个非常好的领导者，他是我狭小交际圈中给到了宝贵的支撑，又高产，技术又好。同时又利用他SMP的工作经验在本书的编码部分中给到了图形化说明。

Greg
我要感谢我老Shanno和我的孩子们Madeline与Griffin，感谢他们在我编纂本书的时候给到了我足够的理解和耐心。如果不是他们的支持，我也无法完成这项任务。同时也感谢Alessandro和Jon 让我荣幸的参加本书的编写。非常感激所有的Linux内核开发者们，为公共版块无私的奉献着，从而让所有人都能学习阅读。当然了还有所有给我提Bug单的朋友，评审代码的朋友，那些指出我代码垃圾的朋友。是你们教会了我怎样成为一个更好的程序员，这一切都让我成为开发者社区中非常受欢迎的一员，多谢你们

